/*
 * jQuery Expander Plugin v1.4.2
 *
 * Date: Sat Mar 31 20:51:48 2012 EDT
 * Requires: jQuery v1.3+
 *
 * Copyright 2011, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses (just like jQuery):
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 *
 *
 *
*/
(function(a){a.expander={version:"1.4.2",defaults:{slicePoint:100,preserveWords:true,widow:4,expandText:"more&#x25BC",expandPrefix:"&hellip; ",expandAfterSummary:false,summaryClass:"summary",detailClass:"details",moreClass:"read-more",lessClass:"read-less",collapseTimer:0,expandEffect:"slideDown",expandSpeed:250,collapseEffect:"slideUp",collapseSpeed:200,userCollapse:true,userCollapseText:"less&#x25B2",userCollapsePrefix:" ",onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null}};a.fn.expander=function(r){var n="init";if(typeof r=="string"){n=r;r={}}var b=a.extend({},a.expander.defaults,r),e=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i,l=b.wordEnd||/(&(?:[^;]+;)?|[a-zA-Z\u00C0-\u0100]+)$/,k=/<\/?(\w+)[^>]*>/g,h=/<(\w+)[^>]*>/g,m=/<\/(\w+)>/g,d=/(<\/[^>]+>)\s*$/,o=/^<[^>]+>.?/,p;var g={init:function(){this.each(function(){var P,O,U,B,T,R,K,u,V,z,M,Q,x=[],I=[],y={},S=this,D=a(this),A=a([]),N=a.meta?a.extend({},b,D.data()):b,t=!!D.find("."+N.detailClass).length,E=!!D.find("*").filter(function(){var W=a(this).css("display");return(/^block|table|list/).test(W)}).length,w=E?"div":"span",G=w+"."+N.detailClass,L="span."+N.moreClass,s=N.expandSpeed||0,C=a.trim(D.html()),F=a.trim(D.text()),H=C.slice(0,N.slicePoint);if(a.data(this,"expander")){return}a.data(this,"expander",true);a.each(["onSlice","beforeExpand","afterExpand","onCollapse"],function(W,X){y[X]=a.isFunction(N[X])});H=j(H);T=H.replace(k,"").length;while(T<N.slicePoint){B=C.charAt(H.length);if(B=="<"){B=C.slice(H.length).match(o)[0]}H+=B;T++}H=j(H,N.preserveWords);R=H.match(h)||[];K=H.match(m)||[];U=[];a.each(R,function(W,X){if(!e.test(X)){U.push(X)}});R=U;O=K.length;for(P=0;P<O;P++){K[P]=K[P].replace(m,"$1")}a.each(R,function(W,Z){var X=Z.replace(h,"$1");var Y=a.inArray(X,K);if(Y===-1){x.push(Z);I.push("</"+X+">")}else{K.splice(Y,1)}});I.reverse();if(!t){V=C.slice(H.length);z=a.trim(V.replace(k,""));if(z===""||z.split(/\s+/).length<N.widow){return}u=I.pop()||"";H+=I.join("");V=x.join("")+V}else{V=D.find(G).remove().html();H=D.html();C=H+V;u=""}N.moreLabel=D.find(L).length?"":q(N);if(E){V=C}H+=u;N.summary=H;N.details=V;N.lastCloseTag=u;if(y.onSlice){U=N.onSlice.call(S,N);N=U&&U.details?U:N}var J=f(N,E);D.html(J);M=D.find(G);Q=D.find(L);M.hide();Q.find("a").unbind("click.expander").bind("click.expander",v);A=D.find("div."+N.summaryClass);if(N.userCollapse&&!D.find("span."+N.lessClass).length){D.find(G).append('<span class="'+N.lessClass+'">'+N.userCollapsePrefix+'<a href="#">'+N.userCollapseText+"</a></span>")}D.find("span."+N.lessClass+" a").unbind("click.expander").bind("click.expander",function(W){W.preventDefault();clearTimeout(p);var X=a(this).closest(G);c(N,X);if(y.onCollapse){N.onCollapse.call(S,true)}});function v(W){W.preventDefault();Q.hide();A.hide();if(y.beforeExpand){N.beforeExpand.call(S)}M.stop(false,true)[N.expandEffect](s,function(){M.css({zoom:""});if(y.afterExpand){N.afterExpand.call(S)}i(N,M,S)})}})},destroy:function(){if(!this.data("expander")){return}this.removeData("expander");this.each(function(){var t=a(this),u=a.meta?a.extend({},b,t.data()):b,s=t.find("."+u.detailClass).contents();t.find("."+u.moreClass).remove();t.find("."+u.summaryClass).remove();t.find("."+u.detailClass).after(s).remove();t.find("."+u.lessClass).remove()})}};if(g[n]){g[n].call(this)}function f(v,u){var t="span",s=v.summary;if(u){t="div";if(d.test(s)&&!v.expandAfterSummary){s=s.replace(d,v.moreLabel+"$1")}else{s+=v.moreLabel}s='<div class="'+v.summaryClass+'">'+s+"</div>"}else{s+=v.moreLabel}return[s,"<",t+' class="'+v.detailClass+'"',">",v.details,"</"+t+">"].join("")}function q(t){var s='<span class="'+t.moreClass+'">'+t.expandPrefix;s+='<a href="#">'+t.expandText+"</a></span>";return s}function j(s,t){if(s.lastIndexOf("<")>s.lastIndexOf(">")){s=s.slice(0,s.lastIndexOf("<"))}if(t){s=s.replace(l,"")}return a.trim(s)}function c(t,s){s.stop(true,true)[t.collapseEffect](t.collapseSpeed,function(){var u=s.prev("span."+t.moreClass).show();if(!u.length){s.parent().children("div."+t.summaryClass).show().find("span."+t.moreClass).show()}})}function i(t,s,u){if(t.collapseTimer){p=setTimeout(function(){c(t,s);if(a.isFunction(t.onCollapse)){t.onCollapse.call(u,false)}},t.collapseTimer)}}return this};a.fn.expander.defaults=a.expander.defaults})(jQuery);